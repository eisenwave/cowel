# COWEL utilities

The files in this directory are portable and generally useful utilities
which may be useful even outside of COWEL.

## `code_point_by_name`

The `code_point_by_name` function is implemented using third-party code from LLVM,
some of which is auto-generated:

- `code_point_by_name.hpp` simply contains the function declaration
- `code_point_by_name_autogenerated.cpp.txt`
   contains the auto-generated output from
   [UnicodeNameMappingGenerator.cpp](https://github.com/llvm/llvm-project/blob/c7d373ac038d35d4cc7a9ea8d9c0073da81716aa/llvm/utils/UnicodeData/UnicodeNameMappingGenerator.cpp) (with modifications)
- `code_point_by_name.cpp` is a manually modified version of
   [UnicodeNameToCodepoint.cpp](https://github.com/llvm/llvm-project/blob/c7d373ac038d35d4cc7a9ea8d9c0073da81716aa/llvm/lib/Support/UnicodeNameToCodepoint.cpp#L69);
   see <https://llvm.org/LICENSE.txt> for license information

To recreate these files step by step,
do the following:

1. Clone the `llvm-project` repo and set up your toolchain for building LLVM.
1. Modify `UnicodeNameMappingGenerator.cpp` so that it no longer requires
   `correction`, `alternate`, or `control` alias categories.
1. Build LLVM.
1. Run `build/bin/UnicodeNameMappingGenerator`
   with the `UnicodeData.txt` and `NameAliases.txt` files obtained from the Unicode standard.
   The output is `code_point_by_name_autogenerated.cpp.txt`.
1. Remove the include of `Compiler.h` from `code_point_by_name_autogenerated.cpp.txt`.
1. Port `UnicodeNameToCodepoint.cpp` to `code_point_by_name.cpp`.

> [!NOTE]
> `UnicodeData.txt` and `NameAliases.txt` may change
> with more recent versions of the Unicode standard,
> and so some of these steps may need to be performed as part of regular maintenance.
